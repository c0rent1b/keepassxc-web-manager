# =============================================================================
# KeePassXC Web Manager - Environment Variables
# =============================================================================
# Copy this file to .env and fill in your values
# ⚠️  NEVER commit .env to version control!

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
APP_NAME="KeePassXC Web Manager"
APP_VERSION="2.0.0-alpha"
ENVIRONMENT="development"  # development, staging, production
DEBUG=true

# Server configuration
HOST="127.0.0.1"
PORT=8000
WORKERS=4  # Number of uvicorn workers (production only)
RELOAD=true  # Auto-reload on code changes (development only)

# =============================================================================
# SECURITY
# =============================================================================
# ⚠️  CHANGE THIS IN PRODUCTION! Generate with: openssl rand -hex 32
SECRET_KEY="your-super-secret-key-change-me-in-production-min-32-chars"

# JWT Configuration
ACCESS_TOKEN_EXPIRE_MINUTES=30
ALGORITHM="HS256"

# Session Configuration
SESSION_TIMEOUT=1800  # 30 minutes in seconds
SESSION_CLEANUP_INTERVAL=300  # 5 minutes in seconds

# Rate Limiting
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_LOGIN_ATTEMPTS=5

# CORS Configuration (comma-separated list)
ALLOWED_ORIGINS="http://localhost:8000,http://127.0.0.1:8000"
ALLOWED_HOSTS="localhost,127.0.0.1"

# =============================================================================
# DATABASE (SQLite for metadata - NON-SENSITIVE DATA ONLY)
# =============================================================================
DATABASE_URL="sqlite+aiosqlite:///./data/keepass_metadata.db"

# ⚠️  SECURITY VALIDATION
# This should ALWAYS be false - prevents storing sensitive data in DB
ALLOW_SENSITIVE_DATA_IN_DB=false

# Connection pool (for production)
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30

# =============================================================================
# CACHE (Redis)
# =============================================================================
# Cache backend: "redis" or "memory"
CACHE_BACKEND="redis"

# Redis configuration
REDIS_HOST="localhost"
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=""  # Leave empty if no password
REDIS_URL="redis://localhost:6379/0"

# Cache TTL (Time To Live) in seconds
CACHE_TTL_ENTRIES=300  # 5 minutes
CACHE_TTL_ENTRY_DETAILS=600  # 10 minutes
CACHE_TTL_DATABASE_INFO=900  # 15 minutes
CACHE_TTL_SEARCH_RESULTS=120  # 2 minutes

# Fallback to memory cache if Redis unavailable
CACHE_FALLBACK_TO_MEMORY=true

# =============================================================================
# KEEPASSXC CLI
# =============================================================================
# Path to keepassxc-cli executable (auto-detected if in PATH)
KEEPASSXC_CLI_PATH="keepassxc-cli"

# CLI timeout (seconds)
KEEPASSXC_CLI_TIMEOUT=30

# Maximum file size for .kdbx files (in bytes) - 50MB default
MAX_KDBX_FILE_SIZE=52428800

# =============================================================================
# LOGGING
# =============================================================================
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL="INFO"

# Log format: "json" or "text"
LOG_FORMAT="json"

# Log file path (empty = stdout only)
LOG_FILE="logs/keepassxc-web-manager.log"

# Log rotation
LOG_MAX_SIZE=10485760  # 10MB
LOG_BACKUP_COUNT=5

# Audit logging (to database)
AUDIT_LOGGING_ENABLED=true

# =============================================================================
# FRONTEND
# =============================================================================
# Theme: "light", "dark", or "auto"
DEFAULT_THEME="auto"

# Pagination
ENTRIES_PER_PAGE=20
MAX_ENTRIES_PER_PAGE=100

# UI Features
ENABLE_DARK_MODE=true
ENABLE_FAVORITES=true
ENABLE_RECENT_ENTRIES=true

# =============================================================================
# SECURITY FEATURES
# =============================================================================
# Password generation defaults
PASSWORD_DEFAULT_LENGTH=16
PASSWORD_INCLUDE_SYMBOLS=true
PASSWORD_INCLUDE_NUMBERS=true
PASSWORD_INCLUDE_UPPERCASE=true
PASSWORD_INCLUDE_LOWERCASE=true
PASSWORD_EXCLUDE_AMBIGUOUS=true

# Security analysis
ENABLE_SECURITY_ANALYSIS=true
ENABLE_WEAK_PASSWORD_DETECTION=true
ENABLE_DUPLICATE_DETECTION=true
ENABLE_HIBP_CHECK=false  # Have I Been Pwned API (requires internet)

# =============================================================================
# EXPORT FEATURES
# =============================================================================
# Allowed export formats (comma-separated)
ALLOWED_EXPORT_FORMATS="html,json,csv"

# Export limits
MAX_EXPORT_ENTRIES=1000
EXPORT_INCLUDE_PASSWORDS_DEFAULT=false

# =============================================================================
# DEVELOPMENT SETTINGS (only for development environment)
# =============================================================================
# Enable API documentation
ENABLE_DOCS=true  # Set to false in production

# Enable detailed error messages
SHOW_ERROR_DETAILS=true  # Set to false in production

# Enable profiling
ENABLE_PROFILING=false

# =============================================================================
# TESTING (only for test environment)
# =============================================================================
TESTING=false
TEST_DATABASE_URL="sqlite+aiosqlite:///:memory:"
TEST_REDIS_URL="redis://localhost:6379/15"  # Use different DB for tests

# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================
# Used when running in Docker
DOCKER_ENABLED=false
DOCKER_REDIS_HOST="redis"  # Service name in docker-compose

# =============================================================================
# MONITORING & METRICS (optional - for production)
# =============================================================================
ENABLE_METRICS=false
METRICS_PORT=9090

# Sentry (error tracking - optional)
SENTRY_DSN=""
SENTRY_ENVIRONMENT="development"

# =============================================================================
# NOTES FOR PRODUCTION DEPLOYMENT
# =============================================================================
# Production checklist:
# - [ ] Change SECRET_KEY to a strong random value
# - [ ] Set DEBUG=false
# - [ ] Set ENVIRONMENT=production
# - [ ] Set RELOAD=false
# - [ ] Configure proper ALLOWED_ORIGINS
# - [ ] Set SHOW_ERROR_DETAILS=false
# - [ ] Set ENABLE_DOCS=false (or protect with authentication)
# - [ ] Configure HTTPS/TLS
# - [ ] Setup log rotation
# - [ ] Configure Redis password
# - [ ] Review rate limiting settings
# - [ ] Enable monitoring (Sentry, metrics)
# - [ ] Setup automated backups for SQLite database
# - [ ] Test all security features
